<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>测试</title>
<meta name="keywords" content="">
<meta name="description" content="">
<style>
	*{margin:0; padding: 0;}
	#box{width: 20px; height: 20px; background: green; position: absolute;}
	.con{width: 20px; height: 20px; background: red; position: absolute; left: 200px; top: 100px;}
	#wrap{width: 1020px; height: 620px; border: 1px solid red; margin:20px auto 0; position: relative;}
	#sd{font-size: 30px; position: absolute; left: 20px; top: 20px;}
	#btn{font-size: 20px; padding: 5px; position: absolute; left: 20px; top: 80px;}
</style>
</head>
<body>
<div id="sd">速度:<span id="sp">1</span></div>
<button id="btn">开始游戏</button>
<div id="wrap">
	<div id="box">1</div>
	<p class="con"></p>
</div>
</body>
<script>
	var wrap=document.getElementById('wrap');
	var box=document.getElementById('box');
	var sp=document.getElementById('sp');
	var btn=document.getElementById('btn');
	var l=0,t=0,time=null;
	var s=false,x=false,z=false,y=true;//标记按键
	var speed=1;

	function Test(){
		//获取box各个方向的距离
		var l1=box.offsetLeft;
		var r1=box.offsetLeft+box.offsetWidth;
		var t1=box.offsetTop;
		var b1=box.offsetTop+box.offsetHeight;

		//获取con各个方向的距离
		var con=wrap.getElementsByTagName('p')[0];
		var l2=con.offsetLeft;
		var r2=con.offsetLeft+con.offsetWidth;
		var t2=con.offsetTop;
		var b2=con.offsetTop+con.offsetHeight;
		if (l1>r2||r1<l2||b1<t2||t1>b2) {//没碰上
			box.style.background='green';
		} else{//碰撞
			box.style.background='yellow';
			wrap.removeChild(con);//删除当前这个块
			speed++;
			sp.innerHTML=speed;
			Create();//插入新块
		};
	}
	function Create(){
		var food=document.createElement('p');
		food.className='con';
		var left=parseInt(Math.random()*1001);
		var top=parseInt(Math.random()*601);
		food.style.left=left+'px';
		food.style.top=top+'px';
		wrap.appendChild(food);
	}
	function Gameover(){
		if (box.offsetLeft>1000) {
			clearInterval(time);
			alert('Game Over\n得分: '+speed);
		};
		if (box.offsetLeft<0) {
			clearInterval(time);
			alert('Game Over\n得分: '+speed);
		};
		if (box.offsetTop>600) {
			clearInterval(time);
			alert('Game Over\n得分: '+speed);
		};
		if (box.offsetTop<0) {
			clearInterval(time);
			alert('Game Over\n得分: '+speed);
		};
	}
	btn.onclick=function (){
		clearInterval(time);
		box.style.left='0px';
		box.style.top='0px';
		s=false;
		x=false;
		z=false;
		y=true;
		speed=1;
		sp.innerHTML=speed;
		time=setInterval(function (){
			if (z) {
				box.style.left=box.offsetLeft-speed+'px';
				Test();
				Gameover();
			};
			if (y) {
				box.style.left=box.offsetLeft+speed+'px';
				Test();
				Gameover();
			};
			if (s) {
				box.style.top=box.offsetTop-speed+'px';
				Test();
				Gameover();
			};
			if (x) {
				box.style.top=box.offsetTop+speed+'px';
				Test();
				Gameover();
			};
		},20);
	}
	document.onkeydown=function (ev){
		var e=ev||window.event;
		switch(e.keyCode){
			case 37:
				z=true;
				y=false;
				s=false;
				x=false;
				break;
			case 38:
				s=true;
				z=false;
				y=false;
				x=false;
				break;
			case 39:
				y=true;
				z=false;
				s=false;
				x=false;
				break;
			case 40:
				x=true;
				z=false;
				y=false;
				s=false;
				break;
		}
	}
	
</script>
</html>